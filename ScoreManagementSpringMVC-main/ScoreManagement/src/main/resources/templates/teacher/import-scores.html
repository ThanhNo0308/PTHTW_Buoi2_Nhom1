html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>Nhập điểm từ CSV</title>
    <th:block th:replace="base :: styles"></th:block>
</head>
<body>
    <div th:replace="base :: header"></div>
    
    <div class="container mt-4">
        <h2 class="mb-4">
            <i class="fas fa-file-import"></i> Nhập điểm từ file CSV
        </h2>
        
        <!-- Thông báo -->
        <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle"></i> <span th:text="${successMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        
        <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-circle"></i> <span th:text="${errorMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        
        <!-- Form nhập điểm -->
        <div class="card shadow mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">Nhập điểm từ file CSV</h5>
            </div>
            <div class="card-body">
                <form th:action="@{/teacher/scores/import}" method="post" enctype="multipart/form-data">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="subjectTeacherId" class="form-label">Môn học</label>
                            <select id="subjectTeacherId" name="subjectTeacherId" class="form-select" required>
                                <option value="">-- Chọn môn học --</option>
                                <option th:each="subj : ${subjectTeachers}" 
                                        th:value="${subj.id}" 
                                        th:text="${subj.subjectId.subjectCode + ' - ' + subj.subjectId.subjectName}">
                                </option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="classId" class="form-label">Lớp học</label>
                            <select id="classId" name="classId" class="form-select" required>
                                <option value="">-- Chọn lớp học --</option>
                                <option th:each="class : ${classes}" 
                                        th:value="${class.id}" 
                                        th:text="${class.classCode + ' - ' + class.className}">
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="schoolYearId" class="form-label">Năm học</label>
                            <select id="schoolYearId" name="schoolYearId" class="form-select" required>
                                <option value="">-- Chọn năm học --</option>
                                <option th:each="year : ${schoolYears}" 
                                        th:value="${year.id}" 
                                        th:text="${year.yearStart + '-' + year.yearEnd + ' ' + year.semesterName}">
                                </option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="file" class="form-label">Chọn file CSV</label>
                            <input class="form-control" type="file" id="file" name="file" accept=".csv" required>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle"></i> Hướng dẫn:</h6>
                        <ul>
                            <li>File CSV phải có định dạng: Mã SV, Họ tên, Điểm GK, Điểm CK, [Điểm bổ sung 1], [Điểm bổ sung 2], [Điểm bổ sung 3]</li>
                            <li>Dòng đầu tiên nên là tiêu đề các cột</li>
                            <li>Điểm số phải trong khoảng từ 0 đến 10</li>
                            <li>Nếu điểm trống, để trống ô đó trong CSV</li>
                        </ul>
                    </div>
                    
                    <div class="mb-3">
                        <a th:href="@{/teacher/scores/template}" class="btn btn-outline-secondary">
                            <i class="fas fa-download"></i> Tải file mẫu
                        </a>
                        <button type="submit" class="btn btn-primary float-end">
                            <i class="fas fa-upload"></i> Nhập điểm
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Thông tin thêm -->
        <div class="card shadow">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-question-circle"></i> Câu hỏi thường gặp</h5>
            </div>
            <div class="card-body">
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                Làm thế nào để tạo file CSV?
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                <p>Bạn có thể tạo file CSV bằng Excel hoặc các trình soạn thảo văn bản. Trong Excel, sau khi nhập dữ liệu, chọn "Lưu dưới dạng" và chọn định dạng "CSV (Comma delimited)".</p>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                Làm thế nào để xử lý lỗi khi nhập điểm?
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
                            <div class="accordion-body">
                                <p>Nếu gặp lỗi, hệ thống sẽ hiển thị thông báo. Vui lòng kiểm tra:</p>
                                <ul>
                                    <li>Mã sinh viên có đúng không</li>
                                    <li>Định dạng điểm có phù hợp không (số từ 0-10)</li>
                                    <li>File CSV có đúng định dạng không</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div th:replace="base :: footer"></div>
</body>
</html>